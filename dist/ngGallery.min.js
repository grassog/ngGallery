!function(e,n,l){"use strict";var o=n.module("ngGallery",["ngAnimate"]),a=n.element,t=n.isDefined,i=(document.body||document.documentElement).style,r=t(i.animation)||t(i.WebkitAnimation)||t(i.MozAnimation)||t(i.MsAnimation)||t(i.OAnimation),s="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend";o.provider("ngGallery",function(){var o=this.defaults={showClose:!0,prefix:"",prevClass:"",nextClass:"",prevLabel:"<",nextLabel:">",closeLabel:"x",closeClass:"",closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,url:!1,infiniteLoop:!1,timing:!1};this.setDefaults=function(e){n.extend(o,e)};var t,i=0,c=0,g={};this.$get=["$document","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$interval",function(d,u,y,p,m,v,f,C,b){var h=d.find("body"),D={onDocumentKeydown:function(e){27===e.keyCode&&G.close("$escape")},onGalleryKeydown:function(e){return function(){var n=e;37===event.keyCode?n.prevImage():39===event.keyCode&&n.nextImage()}},setBodyPadding:function(e){var n=parseInt(h.css("padding-right")||0,10);h.css("padding-right",n+e+"px"),h.data("ng-dialog-original-padding",n)},resetBodyPadding:function(){var e=h.data("ng-dialog-original-padding");e?h.css("padding-right",e+"px"):h.css("padding-right","")},performCloseDialog:function(n,l){var o=n.attr("id");"undefined"!=typeof e.Hammer?e.Hammer(n[0]).off("tap",t):n.unbind("click"),1===c&&h.unbind("keydown"),n.hasClass("nggallery-closing")||(c-=1),r?n.unbind(s).bind(s,function(){n.scope().$destroy(),n.remove(),0===c&&(h.removeClass("nggallery-open"),D.resetBodyPadding()),m.$broadcast("ngGallery.closed",n)}).addClass("nggallery-closing"):(n.scope().$destroy(),n.remove(),0===c&&(h.removeClass("nggallery-open"),D.resetBodyPadding()),m.$broadcast("ngGallery.closed",n)),g[o]&&(g[o].resolve({id:o,value:l,$dialog:n,remainingGallerys:c}),delete g[o])},closeDialog:function(e,l){var o=e.data("$ngGalleryPreCloseCallback");if(o&&n.isFunction(o)){var a=o.call(e,l);n.isObject(a)?a.closePromise?a.closePromise.then(function(){D.performCloseDialog(e,l)}):a.then(function(){D.performCloseDialog(e,l)},function(){}):a!==!1&&D.performCloseDialog(e,l)}else D.performCloseDialog(e,l)}},G={open:function(r){function s(e){k.images=e;for(var n='<div class="gallery"><button class="gallery-close-btn '+w.closeClass+'" data-ng-click="closeThisDialog()">'+w.closeLabel+"</button>",l=0;l<e.length;++l)n+='<div class="gallery-item animate-show" data-ng-show="visibleID === '+l+'" data-ng-click="closeGallery($event)"><span class="helper"></span><span  data-ng-click="nextImage()"><img src="'+w.prefix+e[l]+'"/></span></div>';return n+='<div class="gallery-prev-next-container"><button class="gallery-prev-btn '+w.prevClass+'" data-ng-click="prevImage()">'+w.prevLabel+'</button><button class="gallery-next-btn '+w.nextClass+'" data-ng-click="nextImage()">'+w.nextLabel+"</button></div></div>"}function d(e,n){return e!==!1?p.get(e).then(function(e){return s(e.data)},function(e){throw console.error(e),"Oh no! Something failed!"}):s(n)}var $=this,w=n.copy(o);r=r||{},n.extend(w,r),i+=1,$.latestID="nggallery"+i;var I;g[$.latestID]=I=y.defer();var x,B,k=n.isObject(w.scope)?w.scope.$new():m.$new();return y.when(d(w.url,w.images)).then(function(o){if(w.showClose&&(o+='<div class="nggallery-close"></div>'),$.$result=x=a('<div id="nggallery'+i+'" class="nggallery"></div>'),x.html('<div class="nggallery-overlay"></div><div class="nggallery-content">'+o+"</div>"),w.controller&&(n.isString(w.controller)||n.isArray(w.controller)||n.isFunction(w.controller))){var r=C(w.controller,{$scope:k,$element:x});x.data("$ngGalleryControllerController",r)}return B=w.appendTo&&n.isString(w.appendTo)?n.element(document.querySelector(w.appendTo)):h,k.visibleID=0,k.nextImage=function(e){v(function(){e!==!0&&k.interval!==l&&(k.clearInterval(k.interval),k.setChangeInterval()),k.visibleID===k.images.length-1?w.infiniteLoop?k.visibleID=0:w.closeByNavigation&&k.closeThisDialog():k.visibleID+=1},0)},k.prevImage=function(){v(function(){0!==k.visibleID?k.visibleID-=1:w.infiniteLoop&&(k.visibleID=k.images.length-1)},0)},k.setChangeInterval=function(){k.interval=b(function(){k.nextImage(!0)},w.timing)},k.clearInterval=function(e){b.cancel(e)},k.closeGallery=function(e){a(e.target).hasClass("gallery-item")&&k.closeThisDialog()},k.closeThisDialog=function(e){D.closeDialog(x,e),k.interval!==l&&k.clearInterval(k.interval)},v(function(){u(x)(k);var e=f.innerWidth-h.prop("clientWidth");h.addClass("nggallery-open");var n=e-(f.innerWidth-h.prop("clientWidth"));n>0&&D.setBodyPadding(n),B.append(x),w.name?m.$broadcast("ngGallery.opened",{dialog:x,name:w.name}):m.$broadcast("ngGallery.opened",x)}),w.timing&&w.timing>0&&k.setChangeInterval(),w.closeByEscape&&h.bind("keydown",D.onDocumentKeydown),h.bind("keydown",D.onGalleryKeydown(k)),t=function(e){var n=w.closeByDocument?a(e.target).hasClass("nggallery-overlay"):!1,l=a(e.target).hasClass("nggallery-close");(n||l)&&G.close(x.attr("id"),l?"$closeButton":"$document")},"undefined"!=typeof e.Hammer?e.Hammer(x[0]).on("tap",t):x.bind("click",t),c+=1,G}).catch(function(e){console.log("error",e)}),{id:"nggallery"+i,closePromise:I.promise,close:function(e){D.closeDialog(x,e)}}},openConfirm:function(e){var l=y.defer(),o={closeByEscape:!1,closeByDocument:!1};n.extend(o,e),o.scope=n.isObject(o.scope)?o.scope.$new():m.$new(),o.scope.confirm=function(e){l.resolve(e);var n=a(document.getElementById(t.id));D.performCloseDialog(n,e)};var t=G.open(o);return t.closePromise.then(function(e){return e?l.reject(e.value):l.reject()}),l.promise},close:function(e,n){var l=a(document.getElementById(e));return l.length?D.closeDialog(l,n):G.closeAll(n),G},closeAll:function(e){var l=document.querySelectorAll(".nggallery");n.forEach(l,function(n){D.closeDialog(a(n),e)})},getDefaults:function(){return o}};return G}]}),o.directive("ngGallery",["ngGallery",function(e){return{restrict:"A",scope:{ngGalleryScope:"="},link:function(l,o,a){o.on("click",function(o){o.preventDefault();var t=n.isDefined(l.ngGalleryScope)?l.ngGalleryScope:"noScope",i=e.getDefaults();e.open({controller:a.ngGalleryController,scope:t,data:a.ngGalleryData,prevClass:a.ngGalleryPrevClass,nextClass:a.ngGalleryNextClass,prevLabel:a.ngGalleryPrevLabel,nextLabel:a.ngGalleryNextLabel,closeLabel:a.ngGalleryCloseLabel,closeClass:a.ngGalleryCloseClass,prefix:a.ngGalleryPrefix,showClose:a.ngGalleryShowClose?a.ngGalleryShowClose?!0:i.showClose:!1,closeByDocument:a.ngGalleryCloseByDocument?a.ngGalleryCloseByDocument?!0:i.closeByDocument:!1,closeByEscape:a.ngGalleryCloseByEscape?a.ngGalleryCloseByEscape?!0:i.closeByEscape:!1,preCloseCallback:a.ngGalleryPreCloseCallback||i.preCloseCallback})})}}}])}(window,window.angular);